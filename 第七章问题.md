# 第七章问题

**1、函数间隔和几何间隔？** **P113**

答：

​			$|\omega \cdot x+b|$可以用来衡量x到超平面的距离

​			$y(\omega \cdot x+b)$可以衡量分类的准确度；同号的，越正，越正确；异号，越负，则越错误

​			**函数间隔**就是$y(\omega \cdot x+b)$

​			

​			函数间隔的弊端在于：当成比例地更改$\omega$和b时，超平面没有改变；但是函数距离却变了。

​			所以应该将$\omega$规范化，令$||\omega||=1$，这就得到了**几何间隔**
$$
\gamma_i=y_i\left(\frac{\omega}{||\omega||} \cdot x_i + \frac{b}{||\omega||} \right)
$$

**2、为什么把$\frac{1}{||\omega||}$转换成$\frac{1}{2}||\omega||^2$去求解，而不是$||\omega||$ 呢？** **P116**

答：

​			希望将问题变成凸二次规划问题。原因是这类问题与线性规划问题的求解难度相近。



​			首先回忆规划问题：

​			线性规划，高中数学；在x-y平面内画出可行区域，然后平移目标函数曲线    
$$
\begin{cases}
x-y-1\geq0 \\
x+y-3\geq0 \quad \text{求}(2x+y)_{min} \\ 
y\leq3
\end{cases}
$$
​			凸二次规划：  
$$
\begin{cases}
x-y-1\geq0 \\
x+y-3\geq0 \quad \text{求}(x^2+y^2)_{min} \\ 
y\leq3
\end{cases}
$$
​			一般形式为：    
$$
\begin{align}
\min_{x}  \quad &\frac{1}{2}x^TQx+c^Tx\\ 
  s.t.\quad &Wx \leq b 
\end{align}
$$

+ 若 Q 为**半正定矩阵**，则上面的目标函数是凸函数，相应的二次规划为凸二次规划问题；此时若约束条件定义的可行域不为空，且目标函数在此可行域有下界，则该问题有全局最小值。

+ 若Q为**正定矩阵**，则该问题有唯一的**全局最小值**。 例如，最简单的正定矩阵就是单位矩阵。在本章中，$||\omega||^2$就是$\omega^TI\omega$，也就有唯一的全局最小值。



再给出凸函数定义：

>  一个函数f满足:
>
> （1）它的定义域是凸集
>
> （2）对于其定义域中的任意两点$x1$，$x2$，对任意$0≤α≤1$，$f(\alpha x_1 +(1-\alpha)x_2)\leq \alpha f(x_1)+(1-\alpha)f(x_2)$
>
> 那么这个函数ff就是凸函数

凸集：

> 如果对于一个集合$S$中的任意两个点$A$和$B$，这两个点的连线$AB$也在$S$内，那么$S$就是一个凸集。
>
> 换句话说，凸集不能有洞，不同有任何凹陷。

​    



**3、如何理解支持向量所在的超平面满足$\omega \cdot x+b=\pm1$?** **P118**

答：

​			in one word，人为规定为1

​			求解优化问题时，原优化方程是
$$
\begin{align}
\max_{\omega,b}  \quad &\frac{\hat{\gamma}}{||\omega||}\\ 
s.t. \quad &y_i(\omega \cdot x_i+b)\geq \hat{\gamma} 
\end{align}
$$
​			其中$\hat{\gamma}$是训练集T中的最小的函数距离：
$$
\hat{\gamma} = \min_{i=1,...,N} \hat{\gamma_i}
$$
​			但是由于将$\hat{\gamma}$取为1不影响优化问题的解，于是代入1，得到了
$$
\begin{align}
\max_{\omega,b}  \quad &\frac{1}{||\omega||}\\ 
s.t. \quad &y_i(\omega \cdot x_i+b)\geq 1 
\end{align}
$$
​			这个式子的意义就在于，默认距离超平面最近的点的函数间隔==1，几何间隔==$\frac {1}{||\omega||}$。换言之，超平面到最近的实例点的函数距离被人为规定为1。

​			在加上$y_i\in\{+1,-1\}$，函数间隔定义式$\hat{\gamma_i}=1=y_i(\omega \cdot x_i+b)$

​			就可知最近的点一定满足$\omega \cdot x+b=\pm1$

   

​    

**4、如何理解松弛变量？** **P126**

答：

​			松弛变量在“正确率”和“鲁棒性”之间进行trade off

​			硬间隔的SVM不允许分类错误，两边支持向量所在超平面H1，H2之间没有实例点

​			软间隔的SVM允许分类错误



​			硬间隔的SVM要求每一个实例的函数距离都满足$y_i(\omega \cdot x_i+b)\geq 1$

​			但是软间隔则放宽了要求，给每一个实例$x_i$一个松弛变量$\xi_i$，变成$y_i(\omega \cdot x_i+b)\geq 1-\xi_i$

​			最终的loss变成
$$
\frac{1}{2}||\omega||^2+C \sum_{i=1}^N\xi_i
$$
​			左边关注扩大函数间隔，与硬间隔一样，提高分类准确率；右边$\xi_i$越大，对该实例$x_i$的容忍度越大，但是整体的loss也会上升

​			所以好的loss应该是：保证大多数正确，只给极个别实例分配比较大的$\xi_i$，从而使得函数间隔能够扩大，$||\omega||^2$减小

> ​		P131 也引入了合页损失函数:    
> $$
> L(y(\omega \cdot x+b))=[1-y_i(\omega \cdot x_i+b)]_+  
> $$
> ​		并说明：  
> $$
> \begin{align}
> \max_{\omega,b,\xi}  \quad &\frac{1}{2}||\omega||^2+C\sum_{i=1}^N\xi_i\\ 
> s.t. \quad &y_i(\omega \cdot x_i+b)\geq 1-\xi_i\\
> &\xi_i\geq1
> \end{align}
> $$
> ​		等价最优化问题:  
> $$
> \min_{\omega,b}  \quad \sum_{i=1}^N[1-y_i(\omega \cdot x_i+b)]_++\lambda||\omega||^2
> $$
> ​		合页损失函数是0-1损失函数的上界，可以作为0-1损失函数的代理函数

​	



​     

**5、如何理解SVM核技巧的作用** **P133**

答：

​			假如某二维空间分类问题，正例分布在单位圆内，负例分布在单位圆外。

​			那么一个靠谱（不一定最优）的分类器就是$x^2+y^2=1$这个曲面

​			但是我们仍希望用线性分类方法去求解，一个简单的思想就是：将问题转换到一个横轴为$x^2$，纵轴为$y^2$的空间内，然后$x^2+y^2=1$这样的超平面对应的参数$\omega=[1,1]$

​			类似的，如果最优的分类面不是单位圆，$\frac{x^2}{a^2}+\frac{y^2}{b^2}=1$，超平面对应的参数$\omega=[a^2,b^2]$

​			这样，源空间中的圆（椭圆），在新的空间中就是一条直线。

  

​      

**6、如何理解核函数必须是正定核？** **P136**

答：

​			我不也知道。。。



​    

**7、核函数与算法表现的关系** **P140**

答：

​			复杂的核函数==取复杂特征

​			什么样的核函数是复杂的？以及核函数中哪一个参数控制了复杂度？

​			以高斯核函数为例：
$$
K(x,z)=\exp\left(-\frac{||x-z||^2}{2\sigma^2}\right)
$$
​			该式实际上从$R^n$是映射到了无穷维$H=R^\infty$，因为exp展开就是无穷级数。
$$
1-\frac{||x-z||^2\sigma^2}{2}+\frac{||x-z||^4\sigma^4}{8}-\frac{||x-z||^6\sigma^6}{48}+O(x^7)
$$
​			可以看出，$x^i$的系数的量级为$O(\sigma^i)$的，**所以$\sigma$越小，后面高维项就越不重要**

​			如果不展开来理解的话，$\sigma$越大整个钟型函数越扁（联系正态分布），相当于两个相差很大的特征向量也可以互相作用，而且这种作用并不集中；反之钟型函数很集中，相当于只有原始特征空间内相近的两个实例向量才有内积。
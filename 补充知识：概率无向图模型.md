# 补充知识：概率无向图模型

- 定义：用图表示概率分布。结点v表示一个随机变量Y，边e表示随机变量之间的依赖关系

  如果满足下面是任意一种马尔科夫性，就可以称此分布为概率无向图模型。

  

  black是给定的结点，red和blue是在black确定后独立的结点。相当于在black位置发生了马尔科夫性。
  $$
  P(Y_{red},Y_{blue}|Y_{black})=P(Y_{red}|Y_{black})P(Y_{blue}|Y_{black})
  $$
  

  下面三个马尔科夫定义是等价的。

  - 成对马尔可夫性

    ![11CRF-成对马尔可夫性](E:/KeepLearning/MathforCoder/imageforbook/11CRF-%E6%88%90%E5%AF%B9%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%80%A7.jpg)

  - 局部马尔科夫性

    ![11CRF-局部马尔可夫性](E:/KeepLearning/MathforCoder/imageforbook/11CRF-%E5%B1%80%E9%83%A8%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%80%A7.jpg)

  - 全局马尔科夫性

    点集A与点集B在点集C给定时无关

    ![11CRF-全局马尔可夫性](E:/KeepLearning/MathforCoder/imageforbook/11CRF-%E5%85%A8%E5%B1%80%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%80%A7.png)



- 无向图模型的因子分解

  将无向图模型的联合概率分布表示为其**最大团**上的随机变量的函数的乘积。这个思想是参考了有向图的思路。

  - 团：一个无向图的结点子集，任何两个结点都有边链接
  - 最大团：结点数最大的团。不能再加一个结点使其变成更大的团

  ![11CRF-团](E:/KeepLearning/MathforCoder/imageforbook/11CRF-%E5%9B%A2.png)

  上图中两个最大团$\{Y_1,Y_2,Y_3\},\{Y_2,Y_3,Y_4\}$
  $$
  \begin{align}
  P(Y_1,Y_2,Y_3,Y_4)&=P(Y_1|Y_2,Y_3)P(Y_4|Y_2,Y_3)P(Y_2,Y_3) & \text{全局马尔科夫性}\\
  &=P(Y_1|Y_2,Y_3)\sqrt{P(Y_2,Y_3)}*P(Y_4|Y_2,Y_3)\sqrt{P(Y_2,Y_3)}  & \text{分成两个最大团}\\
  &=\Psi_{Y_1,Y_2,Y_3}\Psi_{Y_2,Y_3,Y_4}& \text{强行写作两个最大团的函数}\\
  \end{align}
  $$
  

  以上是一个美好的设想，<u>如果所有无向图都能这么分解，那么计算就很容易了</u>

  但是幸运的是，**Hammersley-Clifford定理**保证了这一事实：

  - 只要给定一个概率图模型，都可以写作是最大团的势函数$\Psi$的乘积

  $$
  \begin{aligned} 
  P(Y) &= \frac{1}{Z} \prod_C \Psi_C(Y_C) \\ Z &= \sum_Y\prod_C \Psi_C(Y_C) \end{aligned}
  $$

  - 其中$\Psi_C(Y_C)$称为C的势函数，势函数通常是指数函数。
    $$
    \Psi_C(Y_C) = \exp \left \{-E(Y_C) \right \} \quad\text{E是边集}
    $$
    